{% extends "base.html" %}
{% load thumbnail %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<!--<h1>Dashboard</h1>-->

<!--{% with total_images_created=request.user.images_created.count %}-->
<!--    <p>Welcome to your dashboard. You have bookmarked {{ total_images_created }} image{{ total_images_created|pluralize }}.</p>-->
<!--{% endwith %}-->

<!--<p>Drag the following button to your bookmarks toolbar to bookmark images from other websites → <a href="javascript:{% include "bookmarklet_launcher.js" %}" class="button">Bookmark it</a></p>-->
<!--<p>You can also <a href="{% url "edit" %}">edit your profile</a> or <a href="{% url "password_change" %}">change your password</a>.</p>-->

<!--<p>Welcome to your dashboard.You can <a href="{% url "edit" %}">edit your profile</a> or <a href="{% url "password_change" %}">change your password</a>.</p>-->

<!--<h2>What's happening</h2>-->
<!--<div id="action-list">-->
<!--    {% for action in actions %}-->
<!--        {% include "actions/action/detail.html" %}-->
<!--    {% endfor %}-->
<!--</div>-->

<section class="newsfeed">
	  <div class="container-fluid">
	   <div class="row">
	    <div class="col-lg-3">
         {% for image in images %}
         <a href="#">
             <div class="storybox" style="background: linear-gradient( rgba(34,34,34,0.78), rgba(34,34,34,0.78)), url('{{image.image.url}}') no-repeat;
                      background-size: cover;
                          background-position: center center;
                          -webkit-background-size: cover;
                          -moz-background-size: cover;
                          -o-background-size: cover;">
                  <div class="story-body text-center">
                  {% if image.user.profile.photo %}
                    {% with ph=image.user.profile.photo %}
                        <a href="{{ user.get_absolute_url }}"><img class="img-circle" src="{{ph.url}}" alt="Image"></a>
                    {% endwith %}
                  {% else %}
                    <a href="#"><img class="img-circle" src="/static/img/person.jpg" alt="Image"></a>
                  {% endif %}
                  {% if image.user.profile.first_name %}
                    <h4>{{image.user.profile.first_name}}</h4>
                  {% else %}
                    <h4>ناشناس</h4>
                  {% endif %}
                   <p>{{image.created|timesince}} ago</p>
                  </div>
             </div>
         </a>
         {% endfor %}

        <div class="trending-box hidden-xs hidden-md">
         <div class="row">
          <div class="col-lg-12">
            <a href="/images/"><h4>عکس های بیشتر</h4></a>
          </div>
		    </div>
       </div>
		</div><!--/ col-lg-3 -->

		<div id="image_following" class="col-lg-6">
			{% include "account/dashboard_ajax.html" %}
		</div><!--/ col-lg-6 -->

		<div class="col-lg-3">

         <div class="suggestion-box full-width">
			<div class="suggestions-list">
				<div class="suggestion-body">
					<img class="img-responsive img-circle" src="assets/img/users/17.jpeg" alt="Image">
					<div class="name-box">
						<h4>Anthony McCartney</h4>
						<span>@antony</span>
					</div>
					<span><i class="fa fa-plus"></i></span>
				</div>
				<div class="suggestion-body">
					<img class="img-responsive img-circle" src="assets/img/users/16.jpg" alt="Image">
					<div class="name-box">
						<h4>Sean Coleman</h4>
						<span>@sean</span>
					</div>
					<span><i class="fa fa-plus"></i></span>
				</div>
				<div class="suggestion-body">
					<img class="img-responsive img-circle" src="assets/img/users/14.jpg" alt="Image">
					<div class="name-box">
						<h4>Francis Long</h4>
						<span>@francis</span>
					</div>
					<span><i class="fa fa-plus"></i></span>
				</div>
				<div class="suggestion-body">
					<img class="img-responsive img-circle" src="assets/img/users/11.jpg" alt="Image">
					<div class="name-box">
						<h4>Vanessa Wells</h4>
						<span>@vannessa</span>
					</div>
					<span><i class="fa fa-plus"></i></span>
				</div>
				<div class="suggestion-body">
					<img class="img-responsive img-circle" src="assets/img/users/9.jpg" alt="Image">
					<div class="name-box">
						<h4>Anna Morgan</h4>
						<span>@anna</span>
					</div>
					<span><i class="fa fa-plus"></i></span>
				</div>
				<div class="suggestion-body">
					<img class="img-responsive img-circle" src="assets/img/users/8.jpg" alt="Image">
					<div class="name-box">
						<h4>Clifford Graham</h4>
						<span>@clifford</span>
					</div>
					<span><i class="fa fa-plus"></i></span>
				</div>
			</div><!--suggestions-list end-->
		</div>

        <div class="trending-box">
		 <div class="row">
		  <div class="col-lg-12">
		    <h4>Trending Photos</h4>
		  </div>
		 </div>
        </div>

        <div class="trending-box">
		 <div class="row">
		  <div class="col-lg-6">
		   <a href="#"><img src="assets/img/posts/17.jpg" class="img-responsive" alt="Image"></a>
		  </div>
		  <div class="col-lg-6">
		   <a href="#"><img src="assets/img/posts/12.jpg" class="img-responsive" alt="Image"></a>
		  </div>
		 </div>
		 <div class="row">
		  <div class="col-lg-6">
		   <a href="#"><img src="assets/img/posts/21.gif" class="img-responsive" alt="Image"></a>
		  </div>
		  <div class="col-lg-6">
		   <a href="#"><img src="assets/img/posts/23.gif" class="img-responsive" alt="Image"></a>
		  </div>
		 </div>
		 <div class="row">
		  <div class="col-lg-6">
		   <a href="#"><img src="assets/img/posts/11.jpg" class="img-responsive" alt="Image"></a>
		  </div>
		  <div class="col-lg-6">
		   <a href="#"><img src="assets/img/posts/20.jpg" class="img-responsive" alt="Image"></a>
		  </div>
		 </div>
        </div>


		</div>

	   </div><!--/ row -->
	  </div><!--/ container -->
	 </section>
{% endblock %}

{% block domready %}
var page = 1;
var empty_page = false;
var block_request = false;
$(window).scroll(function() {
		var margin = $(document).height() - $(window).height() - 200;
		if ($(window).scrollTop() > margin && empty_page == false && block_request == false) {
				block_request = true;
				page += 1;
				console.log('page',page)
				$.get('?page=' + page, function(data) {
						if(data == '') {
								empty_page = true;
						}
						else {
								block_request = false;
								$('#image_following').append(data);
						}
				});
		}
});

$(".dropdown-item-first").on('click',function(e){
	console.log("ggggggg");
	$(this).parent().parent().parent().parent().css({"display":"none"});
	var ajax_url=$(this).data('url');
	$.ajax({
    url: ajax_url,
    type: 'PUT',
    success: function(data) {
        console.log("hhhhhh");
    }
	});
});

$(".dropdown-item-second").on('click',function(e){
		var ddd=$(this);
		console.log('ddddddddddddddddd');
		$.post('{% url "user_follow" %}',
		{
				id: $(this).data('id'),
				action: $(this).data('action')
		},
		function(data){
				if (data['status'] == 'ok') {
						location.reload();
				}
		}
	);
});

{% endblock %}